<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <title>Moto Payments - Login</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/main.css">

    <script type="text/javascript">
      function login() {
        window.location.href = 'api/login'
      }

      function check_status() {
          const xhr = new XMLHttpRequest();
          xhr.open("GET", "/api/status");
          xhr.send();

          xhr.onload = () => {
              if (xhr.readyState == 4 && xhr.status == 200) {
                window.location.href = 'payments.html'
              } else {
                if (xhr.status == 403) {
                  document.getElementById("payments_wait").classList.add("hide");
                  document.getElementById("main_intro").classList.remove("hide");
                  document.getElementById("login-container").classList.remove("hide");
                }
              }
          };
      }

    </script>

</head>
<body onload="check_status()">

<div style="overflow: hidden;height: 100px;">

    <nav class="demo">
        <ul width="100%">
            <li class="brand">
                <img src="images/logo_royalblue_c.png" style="width: 3em" />
                <h1 style="display: inline">Moto Payments</h1>
            </li>
        </ul>

        <ul>
            <li><a href="faq.html" class="button icon-picture" id="faq-menu-button">FAQ</a></li>
        </ul>
    </nav>

</div>

<main class="container">

    <div id="payments_wait" aria-busy="true"></div>

    <div id="main_intro" class="hide">
        <h4>Welcome to Moto Payments!</h4>
        <p>
            The purpose of this website is to distribute donations that the project receives, to contributors that have submitted PR's.
        </p>
        <p>
            Please login with GitHub below to check if you are eligible to receive some of the donations.
        </p>
    </div>

    <div id="login-container" class="hide">
        <div class="center">
            <span onclick="login()" class="btn btn-block btn-social btn-github center" role="button">
                <i class="fa fa-github"></i> Sign in with GitHub
            </span>
        </div>
    </div>

</main>

</body>
</html>